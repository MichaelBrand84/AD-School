<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AutoDiff - 3&nbsp; Standard Algorithmische Differentiation für eindimensionale Funktionen</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./notAD.html" rel="prev">
<link href="./mycover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Standard Algorithmische Differentiation für eindimensionale Funktionen</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./mycover.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">AutoDiff</a> 
        <div class="sidebar-tools-main">
    <a href="./AutoDiff.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Vorwort</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Ableitungen und ihre Anwendungen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./notAD.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">AD ist nicht …</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ADOneDimManually.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Standard Algorithmische Differentiation für eindimensionale Funktionen</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Inhaltsverzeichnis</h2>
   
  <ul>
  <li><a href="#sec-SadManualImplementation" id="toc-sec-SadManualImplementation" class="nav-link active" data-scroll-target="#sec-SadManualImplementation"><span class="toc-section-number">3.1</span>  Manuelle Implementation der SAD</a></li>
  <li><a href="#sec-SadImplementationOperatorOverloading" id="toc-sec-SadImplementationOperatorOverloading" class="nav-link" data-scroll-target="#sec-SadImplementationOperatorOverloading"><span class="toc-section-number">3.2</span>  Implementation der SAD mit Operator Overloading</a>
  <ul class="collapse">
  <li><a href="#sec-FoatSadClassDescription" id="toc-sec-FoatSadClassDescription" class="nav-link" data-scroll-target="#sec-FoatSadClassDescription"><span class="toc-section-number">3.2.1</span>  Die Klasse <code>FloatSad</code></a></li>
  <li><a href="#vorzeichen" id="toc-vorzeichen" class="nav-link" data-scroll-target="#vorzeichen"><span class="toc-section-number">3.2.2</span>  Vorzeichen</a></li>
  <li><a href="#die-operatoren-und--" id="toc-die-operatoren-und--" class="nav-link" data-scroll-target="#die-operatoren-und--"><span class="toc-section-number">3.2.3</span>  Die Operatoren <code>+</code> und <code>-</code></a></li>
  <li><a href="#die-operatoren-und" id="toc-die-operatoren-und" class="nav-link" data-scroll-target="#die-operatoren-und"><span class="toc-section-number">3.2.4</span>  Die Operatoren <code>*</code> und <code>/</code></a></li>
  <li><a href="#der-operator" id="toc-der-operator" class="nav-link" data-scroll-target="#der-operator"><span class="toc-section-number">3.2.5</span>  Der Operator <code>**</code></a></li>
  <li><a href="#vergleichsopertoren" id="toc-vergleichsopertoren" class="nav-link" data-scroll-target="#vergleichsopertoren"><span class="toc-section-number">3.2.6</span>  Vergleichsopertoren</a></li>
  </ul></li>
  <li><a href="#die-klasse-floatsad-im-einsatz" id="toc-die-klasse-floatsad-im-einsatz" class="nav-link" data-scroll-target="#die-klasse-floatsad-im-einsatz"><span class="toc-section-number">3.3</span>  Die Klasse <code>FloatSad</code> im Einsatz</a></li>
  <li><a href="#das-modul-mathsad" id="toc-das-modul-mathsad" class="nav-link" data-scroll-target="#das-modul-mathsad"><span class="toc-section-number">3.4</span>  Das Modul <code>mathsad</code></a>
  <ul class="collapse">
  <li><a href="#die-funktion-sqrt" id="toc-die-funktion-sqrt" class="nav-link" data-scroll-target="#die-funktion-sqrt"><span class="toc-section-number">3.4.1</span>  Die Funktion <code>sqrt</code></a></li>
  <li><a href="#die-funktionen-exp-und-log" id="toc-die-funktionen-exp-und-log" class="nav-link" data-scroll-target="#die-funktionen-exp-und-log"><span class="toc-section-number">3.4.2</span>  Die Funktionen <code>exp</code> und <code>log</code></a></li>
  <li><a href="#die-trigonometrischen-funktionen-und-ihre-umkehrfunktionen" id="toc-die-trigonometrischen-funktionen-und-ihre-umkehrfunktionen" class="nav-link" data-scroll-target="#die-trigonometrischen-funktionen-und-ihre-umkehrfunktionen"><span class="toc-section-number">3.4.3</span>  Die trigonometrischen Funktionen und ihre Umkehrfunktionen</a></li>
  <li><a href="#die-hyperbolischen-funktionen-und-ihre-umkehrfunktionen" id="toc-die-hyperbolischen-funktionen-und-ihre-umkehrfunktionen" class="nav-link" data-scroll-target="#die-hyperbolischen-funktionen-und-ihre-umkehrfunktionen"><span class="toc-section-number">3.4.4</span>  Die hyperbolischen Funktionen und ihre Umkehrfunktionen</a></li>
  <li><a href="#die-betragsfunktion" id="toc-die-betragsfunktion" class="nav-link" data-scroll-target="#die-betragsfunktion"><span class="toc-section-number">3.4.5</span>  Die Betragsfunktion</a></li>
  </ul></li>
  <li><a href="#das-modul-mathsad-im-einsatz" id="toc-das-modul-mathsad-im-einsatz" class="nav-link" data-scroll-target="#das-modul-mathsad-im-einsatz"><span class="toc-section-number">3.5</span>  Das Modul <code>mathsad</code> im Einsatz</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-SADforOneDimFunctions" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Standard Algorithmische Differentiation für eindimensionale Funktionen</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In <a href="notAD.html"><span>Kapitel&nbsp;2</span></a> haben wir zwei Methoden für die Berechnung von Ableitungen kennen gelernt, die beide ihre Schwächen haben. Während die numerische Ableitung mit geringem Aufwand berechnet werden kann, sind ihre Näherungswerte für viele Anwendungen zu ungenau. Symbolische Ableitungen andererseits liefern zwar exakte Werte von Ableitungen, sind aber mit grossem Rechenaufwand verbunden. Die hier vorgestellte Algorithmische Differentiation (AD) vereinigt die Vorteile der beiden Methoden. Sie liefert uns (bis auf Maschinengenauigkeit) exakte Werte von Ableitungen mit nur einem geringen zusätzlichen Rechenaufwand:</p>
<blockquote class="blockquote">
<p>“AD as a technical term refers to a specific family of techniques that compute derivatives trhough accumulation of values during code execution to generate numerical derivative evaluations rather than derivative expressions. This allows accurate evaluation of derivatives at machine precision with only a small constant factor of overhead and ideal asymptotic efficiency.” (<span class="citation" data-cites="Baydin18">Baydin u.&nbsp;a. (<a href="references.html#ref-Baydin18" role="doc-biblioref">2018</a>)</span>, S. 2)</p>
</blockquote>
<p>In diesem Kapitel lernen wir die <em>Standard Algorithmische Differentiation</em> (SAD, auch Vorwärts-AD genannt) kennen, welche die einfachste Variante der erwähnten “family of techniques” ist. Wir beschränken uns zunächst wieder auf Funktionen <span class="math inline">\(f : \mathbb{R} \rightarrow \mathbb{R}\)</span> und werden dies später auf Funktionen <span class="math inline">\(f : \mathbb{R}^n \rightarrow \mathbb{R}^m\)</span> erweitern. Neben der Standard-AD gibt es noch die <em>Adjungierte Algorithmische Differentiation</em> (AAD, auch Rückwärts-AD genannt). Die Vorteile dieser Methode offenbaren sich jedoch erst für Funktionen in höherdimensionalen Räumen.</p>
<p>Gemäss unserer Konvention in <a href="intro.html#sec-ProgFunc"><span>Kapitel&nbsp;1.2</span></a> berechnen wir eine mathematische Funktion, indem wir sie in ihre Bestandteile zerlegen, und die Zwischenergebnisse Variablen <code>v</code> zuweisen. Wie im obigen Zitat erwähnt, besteht die Grundidee der AD darin, eine Reihe von Hilfsvariablen <code>vdot</code> einzuführen, welche jeweils die Werte der Ableitungen enthalten. In diesem Kapitel machen wir dies explizit, indem wir jede Programmzeile, die ein <code>v</code> berechnet, um die Berechnung des zugehörigen <code>vdot</code> erweitern. Dies scheint zunächst umständlich zu sein, aber im nächsten Abschnitt werden wir eine Klasse schreiben, die diese Schritte für uns automatisiert. Wie Marc Henrard in seinem Buch schreibt:</p>
<blockquote class="blockquote">
<p>“There are as many shades of AD as there are AD users. [This chapter] provides to the user the black and the white; it is up to him to get the correct shade of grey that fits his taste and his requirements.” (<span class="citation" data-cites="Henrard2017ADi">Henrard (<a href="references.html#ref-Henrard2017ADi" role="doc-biblioref">2017</a>)</span>, S. 18)</p>
</blockquote>
<section id="sec-SadManualImplementation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sec-SadManualImplementation"><span class="header-section-number">3.1</span> Manuelle Implementation der SAD</h2>
<p>Beginnen wir mit einem Beispiel:</p>
<p>Wir möchten den Funktionswert und die Ableitung der Funktion <span class="math inline">\(y=f(x)=\sin(x^2)\)</span> an der Stelle <span class="math inline">\(x_0=\frac{\pi}{2}\)</span> bestimmen. Das folgende Programm berechnet den Funktionswert.</p>
<div class="cell" data-execution_count="1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> v0<span class="op">**</span><span class="dv">2</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> math.sin(v1)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v2</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> math.pi <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.6242659526396992</code></pre>
</div>
</div>
<p><span class="math inline">\(f\)</span> ist eine zusammengesetzte Funktion, die wir mit den Funktionen</p>
<p><span class="math display">\[\begin{align*}
    v_0(x)   &amp;= x \\
    v_1(v_0) &amp;= v_0 ^2 \\
    v_2(v_1) &amp;= \sin(v_1)
\end{align*}\]</span></p>
<p>schreiben können als <span class="math inline">\(y=f(x)=v_2(v_1(v_0(x)))\)</span>. Die Ableitung berechnet sich dann mit der Kettenregel zu <span class="math display">\[
f'(x) = \frac{dv_2}{dv_1} \cdot \frac{dv_1}{dv_0} \cdot \frac{dv_0}{dx} = \cos(v_1)\cdot 2v_0 \cdot 1 = \cos(x^2) \cdot 2x \cdot 1
\]</span> Wir können also die Ableitung von <code>f(x)</code> berechnen, indem wir jede Zeile des Programms gemäss den bekannten Regeln ableiten:</p>
<pre><code>v0dot = 1
v1dot = 2 * v0 * v0dot
v2dot = math.cos(v1) * v1dot</code></pre>
<p>Man beachte, dass durch die Konvention, dass immer <code>v0 = x</code> gesetzt wird, auch immer <code>v0dot = 1</code> ist. Nun können wir unsere Funktion so ergänzen, dass nicht nur der Funktionswert, sondern auch die Ableitung an der Stelle <span class="math inline">\(x_0\)</span> berechnet wird:</p>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> v0<span class="op">**</span><span class="dv">2</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> math.cos(v1) <span class="op">*</span> v1dot</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> math.sin(v1)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v2dot</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v2</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> math.pi <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[0.6242659526396992, -2.4542495411512917]</code></pre>
</div>
</div>
<p>Die Korrektheit des Programms können wir mit <a href="https://www.geogebra.org/m/u4rkpzsr">GeoGebra</a> überprüfen, welches Ableitungen symbolisch berechnet.</p>
<div>
<div class="fig-AbleitungenTesten">
<iframe scrolling="no" title="Ableitungen berechnen" src="https://www.geogebra.org/material/iframe/id/nghnrzye/width/700/height/500/border/888888/sfsb/true/smb/false/stb/false/stbh/false/ai/false/asb/false/sri/true/rc/false/ld/false/sdz/true/ctl/false" width="700px" height="500px" style="border:0px;">
</iframe>
</div>
</div>
<p>Beachte, dass wir konsequent die Kettenregel verwendet haben. So wird aus <code>v1 = v0**2</code> etwa <code>v1dot = 2 * v0 * v0dot</code> oder aus <code>v2 = sin(v1)</code> wird <code>v2dot = cos(v1) * v1dot</code>.</p>
<div id="exr-ErstesADBspErweitern" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.1 (Programm ableiten) </strong></span><br></p>
<p>Ändere das vorherige Programm so ab, dass der Funktionswert und die Ableitung der Funktion <span class="math inline">\(y = f(x) = \ln(\sin(x^2))\)</span> an der Stelle <span class="math inline">\(x_0 = \frac{\pi}{2}\)</span> berechnet wird. Überprüfe deine Lösung mit GeoGebra.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Es müssen lediglich zwei weitere Zeilen eingefügt werden und zwar für die Berechnung von <code>v3</code> und <code>v3dot</code>. Vergiss nicht, die richtigen Werte zurückzugeben.</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> v0<span class="op">**</span><span class="dv">2</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> math.cos(v1) <span class="op">*</span> v1dot</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> math.sin(v1)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    v3dot <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> v2 <span class="op">*</span> v2dot</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    v3 <span class="op">=</span> math.log(v2)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v3dot</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v3</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> math.pi <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[-0.4711787952593891, -3.9314166194288416]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Konvention
</div>
</div>
<div class="callout-body-container callout-body">
<p>Ein Programm, welches gemäss der Konvention in <a href="intro.html#sec-ProgFunc"><span>Kapitel&nbsp;1.2</span></a> geschrieben ist, wird folgendermassen abgeleitet:</p>
<ol type="1">
<li>Für jede Variable <code>v</code> wird eine neue Variable <code>vdot</code> für den Wert der Ableitung definiert, angefangen bei <code>v0dot = 1</code>.</li>
<li>Jede Programmzeile wird gemäss den bekannten Regeln aus <a href="intro.html#tbl-DiffGrundfunktionen">Tabelle&nbsp;<span>1.1</span></a> und <a href="intro.html#tbl-DiffRegeln">Tabelle&nbsp;<span>1.2</span></a> abgeleitet. Dabei wird insbesondere in <em>jeder</em> Zeile die Kettenregel verwendet.</li>
<li>Die abgeleitete Anweisung wird jeweils <em>vor</em> (!) die zu ableitende Anweisung eingeschoben.</li>
</ol>
</div>
</div>
<div id="exr-SADProduktregel" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.2 (Produktregel) </strong></span><br></p>
<p>Das folgende Programm berechnet die Funktion <span class="math inline">\(y = f(x) = (2+x)(x-3)\)</span>:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> v0</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> v0 <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v1 <span class="op">*</span> v2</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Leite dieses Programm ab. Dein Programm soll die Gleichung der Tangente <span class="math inline">\(t(x) = f(x_0) + f'(x_0)\cdot (x-x_0)\)</span> an der Stelle <span class="math inline">\(x_0 = 2\)</span> ausgeben.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> v0dot</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> v0</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> v0dot</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> v0 <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v1dot <span class="op">*</span> v2 <span class="op">+</span> v1 <span class="op">*</span> v2dot <span class="co"># Produktregel</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v1 <span class="op">*</span> v2</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>[y0, y0dot] <span class="op">=</span> f(x0)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"t(x) ="</span>, y0, <span class="st">"+"</span>, y0dot, <span class="st">"* ( x -"</span>, x0, <span class="st">")"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>t(x) = -4 + 3 * ( x - 2 )</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exr-SAD1" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.3 (Programm ableiten) </strong></span><br></p>
<p>Leite die Funktion aus <a href="intro.html#exr-ProgToFun">Übungsaufgabe&nbsp;<span>1.1</span></a> ab. Gib den Funktionswert und den Wert der Ableitung an der Stelle <span class="math inline">\(x_0=-2\)</span> aus.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> v0 <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> v1dot</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> v1 <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    v3dot <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> v1dot</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    v3 <span class="op">=</span> <span class="op">-</span>v1 <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    v4dot <span class="op">=</span> <span class="op">-</span>math.sin(v2) <span class="op">*</span> v2dot</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    v4 <span class="op">=</span> math.cos(v2)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    v5dot <span class="op">=</span> math.exp(v3) <span class="op">*</span> v3dot</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    v5 <span class="op">=</span> math.exp(v3)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    v6dot <span class="op">=</span> v4dot <span class="op">*</span> v5 <span class="op">+</span> v4 <span class="op">*</span> v5dot</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    v6 <span class="op">=</span> v4 <span class="op">*</span> v5</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v6dot <span class="op">-</span> <span class="dv">1</span> <span class="op">/</span> v0<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> v0dot</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v6 <span class="op">+</span> <span class="dv">1</span> <span class="op">/</span> v0</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="op">-</span><span class="dv">2</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[-0.3700550823007931, -0.14136926695938976]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exr-SAD2" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.4 (Programm ableiten) </strong></span><br></p>
<p>Leite die Funktion aus <a href="intro.html#exr-FunToGraphProg">Übungsaufgabe&nbsp;<span>1.2</span></a> ab.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> v0 <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> v1dot</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> v1 <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    v3dot <span class="op">=</span> v2dot <span class="op">+</span> v0dot</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    v3 <span class="op">=</span> v2 <span class="op">+</span> v0</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    v4dot <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> v2 <span class="op">*</span> v2dot</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    v4 <span class="op">=</span> math.log(v2)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    v5dot <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> math.sqrt(v3)) <span class="op">*</span> v3dot</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    v5 <span class="op">=</span> math.sqrt(v3)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> (v4dot <span class="op">*</span> v5 <span class="op">-</span> v4 <span class="op">*</span> v5dot) <span class="op">/</span> v5<span class="op">**</span><span class="dv">2</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v4 <span class="op">/</span> v5</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Bei all diesen Beispielen könnten wir auch die Reihenfolge der Anweisungen für <code>vdot</code> und <code>v</code> vertauschen, d.h. zuerst die Variable <code>v</code> berechnen und erst danach das zugehörige <code>vdot</code>. Die folgende Übung zeigt aber, warum der 3. Punkt unserer Konvention wichtig ist.</p>
<div id="exr-SADmitSchleife" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.5 (Ein Programm mit einer Schleife) </strong></span><br></p>
<p>Betrachte die Funktion aus <a href="intro.html#exr-LoopProgToFun">Übungsaufgabe&nbsp;<span>1.3</span></a>, welche aus <span class="math inline">\(\ell(x) = x^2 + 1\)</span> die Funktion <span class="math inline">\(y = f(x) = \ell(\ell(\ell(x)))\)</span> berechnet. Aus <a href="notAD.html#exm-symbDiff">Beispiel&nbsp;<span>2.2</span></a> wissen wir, dass <span class="math inline">\(f'(1) = 80\)</span> ist. Vergleiche nun die beiden Varianten für die Ableitung des Programms:</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true"><code>vdot</code> vor <code>v</code></a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false"><code>v</code> vor <code>vdot</code></a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        v0dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> v0 <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v0dot</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v0</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(<span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[26, 80]</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> v0 <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        v0dot <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> v0 <span class="op">*</span> v0dot</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v0</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> v0dot</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(<span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[26, 2080]</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Warum wird bei der 2. Variante der Wert der Ableitung falsch berechnet?</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Das Problem tritt in der Schleife auf. In der 2. Variante überschreiben wir den Wert von <code>v0</code> bereits mit dem neuen Wert der Iteration. Bei der Berechnung von <code>v0dot</code> hätten wir aber noch den alten Wert gebraucht. Die Reihenfolge ist also nur in der 1. Version korrekt. Würden wir die Schleife eliminieren und dafür wie in der Lösung zu <a href="intro.html#exr-LoopProgToFun">Übungsaufgabe&nbsp;<span>1.3</span></a> für jeden Schleifendurchgang fortlaufend numerierte Variablen für die <code>v</code> und <code>vdot</code> verwenden, dann wäre die Reihenfolge wieder egal.</p>
</div>
</div>
</div>
<p>In der nächsten Übungsaufgabe verwenden wir die Technik der AD, um das Billardproblem aus <a href="intro.html#sec-Newtonverfahren1D"><span>Kapitel&nbsp;1.3.1</span></a> mit dem Newtonverfahren zu lösen. Da uns die Funktion <code>f(x)</code> nun nicht mehr nur der Funktionswert, sondern auch die Ableitung berechnet, können wir das Newtonverfahren ohne die Probleme aus <a href="intro.html#exr-NewtonFirstTry">Übungsaufgabe&nbsp;<span>1.4</span></a> implementieren.</p>
<div id="exr-BillardSADmanualSOlution" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.6 (Das Billard-Problem) </strong></span><br></p>
<p>Leite das Programm aus <a href="intro.html#exm-Billard">Beispiel&nbsp;<span>1.2</span></a> ab. Schreibe danach eine Funktion <code>newton(f, x0)</code>, welche ausnutzt, dass der Funktionsaufruf <code>f(x0)</code> auch den exakten Wert der Ableitung zurückgibt. Stelle alle gefundenen Lösungen grafisch dar.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameter werden im global space gefunden</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Berechnung des Skalarprodukts und dessen Ableitung</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> x</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="op">-</span>math.sin(v0) <span class="op">*</span> v0dot  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> math.cos(v0)  <span class="co"># x-Koordinate von X</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> math.cos(v0) <span class="op">*</span> v0dot   <span class="co"># Ableitung von ...</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> math.sin(v0)  <span class="co"># y-Koordinate von X</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    v3dot <span class="op">=</span> <span class="op">-</span> v1dot    <span class="co"># Ableitung von ...</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    v3 <span class="op">=</span> px <span class="op">-</span> v1       <span class="co"># x-Komponente des Vektors XP</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    v4dot <span class="op">=</span> <span class="op">-</span> v2dot    <span class="co"># Ableitung von ...</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    v4 <span class="op">=</span> py <span class="op">-</span> v2       <span class="co"># y-Komponente des Vektors XP</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    v5dot <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">2</span><span class="op">*</span>math.sqrt(v3<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> v4<span class="op">**</span><span class="dv">2</span>)) <span class="op">\</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> (<span class="dv">2</span><span class="op">*</span>v3<span class="op">*</span>v3dot <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>v4<span class="op">*</span>v4dot)  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    v5 <span class="op">=</span> math.sqrt(v3<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> v4<span class="op">**</span><span class="dv">2</span>)  <span class="co"># Länge des Vektors XP</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    v6dot <span class="op">=</span> (v3dot <span class="op">*</span> v5 <span class="op">-</span> v3 <span class="op">*</span> v5dot) <span class="op">/</span> v5<span class="op">**</span><span class="dv">2</span>  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    v6 <span class="op">=</span> v3 <span class="op">/</span> v5       <span class="co"># x-Komponente des Einheitsvektors eP</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    v7dot <span class="op">=</span> (v4dot <span class="op">*</span> v5 <span class="op">-</span> v4 <span class="op">*</span> v5dot) <span class="op">/</span> v5<span class="op">**</span><span class="dv">2</span>  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    v7 <span class="op">=</span> v4 <span class="op">/</span> v5       <span class="co"># y-Komponente des Einheitsvektors eP</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    v8dot <span class="op">=</span> <span class="op">-</span>v1dot     <span class="co"># Ableitung von ...</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    v8 <span class="op">=</span> a <span class="op">-</span> v1        <span class="co"># x-Komponente des Vektors XQ</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    v9dot <span class="op">=</span> <span class="op">-</span>v2dot     <span class="co"># Ableitung von ...</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    v9 <span class="op">=</span> <span class="op">-</span>v2           <span class="co"># y-Komponente des Vektors XQ</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    v10dot <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (<span class="dv">2</span><span class="op">*</span>math.sqrt(v8<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> v9<span class="op">**</span><span class="dv">2</span>)) <span class="op">\</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span> (<span class="dv">2</span><span class="op">*</span>v8<span class="op">*</span>v8dot <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>v9<span class="op">*</span>v9dot)  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    v10 <span class="op">=</span> math.sqrt(v8<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> v9<span class="op">**</span><span class="dv">2</span>)  <span class="co"># Länge des Vektors XQ</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    v11dot <span class="op">=</span> (v8dot <span class="op">*</span> v10 <span class="op">-</span> v8 <span class="op">*</span> v10dot) <span class="op">/</span> v10<span class="op">**</span><span class="dv">2</span>  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    v11 <span class="op">=</span> v8 <span class="op">/</span> v10     <span class="co"># x-Komponente des Vektors eQ    </span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    v12dot <span class="op">=</span> (v9dot <span class="op">*</span> v10 <span class="op">-</span> v9 <span class="op">*</span> v10dot) <span class="op">/</span> v10<span class="op">**</span><span class="dv">2</span>  <span class="co"># Ableitung von ... </span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    v12 <span class="op">=</span> v9 <span class="op">/</span> v10     <span class="co"># y-Komponente des Vektors eQ   </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> (v6dot <span class="op">+</span> v11dot) <span class="op">*</span> v2 <span class="op">+</span> (v6 <span class="op">+</span> v11) <span class="op">*</span> v2dot <span class="op">\</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span> ( (v7dot <span class="op">+</span> v12dot) <span class="op">*</span> v1 <span class="op">+</span> (v7 <span class="op">+</span> v12) <span class="op">*</span> v1dot )  <span class="co"># Ableitung von ...</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> (v6 <span class="op">+</span> v11) <span class="op">*</span> v2 <span class="op">-</span> (v7 <span class="op">+</span> v12) <span class="op">*</span> v1</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]   </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> newton(f, x0):</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="fl">1e-8</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Erster Schritt berechnen</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    [y0, y0dot] <span class="op">=</span> f(x0)</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> x0 <span class="op">-</span> y0 <span class="op">/</span> y0dot</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> math.fabs(x1 <span class="op">-</span> x0) <span class="op">&gt;</span> tol:</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>        [y0, y0dot] <span class="op">=</span> f(x0)</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0 <span class="op">-</span> y0 <span class="op">/</span> y0dot</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1 </span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameter definieren</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="op">-</span><span class="fl">0.8</span>           <span class="co"># Position von Q = (a|0)</span></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    px, py <span class="op">=</span> <span class="fl">0.5</span>, <span class="fl">0.5</span>  <span class="co"># Position von P = (px|py)</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lösung des Billardproblems berechnen</span></span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> <span class="bu">set</span>({}) <span class="co"># leere Menge, in der die gefundenen Lösungen gespeichert werden</span></span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">2</span><span class="op">*</span>math.pi <span class="op">*</span> k <span class="op">/</span> <span class="dv">10</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]  <span class="co"># Liste der Startwerte für Newton</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x0 <span class="kw">in</span> X:</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> newton(f, x0)</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>        sol.add(x)</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lösungen grafisch darstellen</span></span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure()</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.gca()</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim((<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>))</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim((<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>))</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>    circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>,<span class="dv">0</span>), <span class="dv">1</span>, color<span class="op">=</span><span class="st">'b'</span>, fill<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>    qBall <span class="op">=</span> plt.Circle((a,<span class="dv">0</span>), <span class="fl">0.02</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    pBall <span class="op">=</span> plt.Circle([px, py], <span class="fl">0.02</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(circle)</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(qBall)</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(pBall)</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> sol:</span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a>        xcoords <span class="op">=</span> [a, math.cos(x), px]</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>        ycoords <span class="op">=</span> [<span class="dv">0</span>, math.sin(x), py]</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>        plt.plot(xcoords, ycoords, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-billardproblemsolution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ADOneDimManually_files/figure-html/fig-billardproblemsolution-output-1.png" width="423" height="404" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;3.1: Lösung des Billardproblems.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="exr-MinDistlSolution" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.7 (Minimaler Abstand) </strong></span><br></p>
<p>Leite das Programm aus <a href="intro.html#exm-GDApplication">Beispiel&nbsp;<span>1.3</span></a> ab. Schreibe danach eine Funktion <code>gradient_descent(f, x0, lam)</code>, welche ausnutzt, dass der Funktionsaufruf <code>f(x0)</code> auch den exakten Wert der Ableitung zurückgibt. Stelle die gefundene Lösung grafisch dar.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> d(t):</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    v0dot <span class="op">=</span> <span class="dv">1</span>                    </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> t</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    v1dot <span class="op">=</span> <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> math.sin(v0) <span class="op">*</span> v0dot   <span class="co"># Ableitung von...</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.cos(v0) <span class="op">-</span> <span class="dv">1</span>    <span class="co"># x-Koordinate von P</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    v2dot <span class="op">=</span> <span class="fl">1.5</span> <span class="op">*</span> math.cos(v0) <span class="op">*</span> v0dot  <span class="co"># Ableitung von...</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> <span class="fl">1.5</span> <span class="op">*</span> math.sin(v0)      <span class="co"># y-Koordinate von P</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    v3dot <span class="op">=</span> <span class="dv">0</span>                    <span class="co"># Ableitung von...</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    v3 <span class="op">=</span> <span class="dv">0</span>                       <span class="co"># z-Koordinate von P</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    v4dot <span class="op">=</span> <span class="op">-</span><span class="dv">6</span> <span class="op">*</span> math.cos(<span class="dv">2</span><span class="op">*</span>v0) <span class="op">*</span> v0dot <span class="co"># Ableitung von...</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    v4 <span class="op">=</span> <span class="op">-</span><span class="dv">3</span> <span class="op">*</span> math.sin(<span class="dv">2</span><span class="op">*</span>v0)     <span class="co"># x-Koordinate von Q</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    v5dot <span class="op">=</span> <span class="op">-</span><span class="dv">4</span> <span class="op">*</span> math.sin(<span class="dv">2</span><span class="op">*</span>v0) <span class="op">*</span> v0dot <span class="co"># Ableitung von...</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    v5 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.cos(<span class="dv">2</span><span class="op">*</span>v0) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># y-Koordinate von Q</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    v6dot <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> math.cos(<span class="dv">2</span><span class="op">*</span>v0) <span class="op">*</span> v0dot  <span class="co"># Ableitung von...</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    v6 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> math.sin(<span class="dv">2</span><span class="op">*</span>v0) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># z-Koordinate von Q</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    ydot <span class="op">=</span> (<span class="dv">2</span><span class="op">*</span>(v4<span class="op">-</span>v1)<span class="op">*</span>(v4dot<span class="op">-</span>v1dot) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>(v5<span class="op">-</span>v2)<span class="op">*</span>(v5dot<span class="op">-</span>v2dot) <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>(v6<span class="op">-</span>v3)<span class="op">*</span>(v6dot<span class="op">-</span>v3dot)) <span class="op">\</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>         <span class="op">/</span> (<span class="dv">2</span> <span class="op">*</span> math.sqrt((v4<span class="op">-</span>v1)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (v5<span class="op">-</span>v2)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (v6<span class="op">-</span>v3)<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> math.sqrt((v4<span class="op">-</span>v1)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (v5<span class="op">-</span>v2)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (v6<span class="op">-</span>v3)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [y, ydot]</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent(f, x0, lam):</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="fl">1e-9</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Erster Schritt berechnen</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    [y0, y0dot] <span class="op">=</span> f(x0)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> x0 <span class="op">-</span> lam <span class="op">*</span> y0dot</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> math.fabs(x1<span class="op">-</span>x0) <span class="op">&gt;</span> tol:</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        [y0, y0dot] <span class="op">=</span> f(x0)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0 <span class="op">-</span> lam <span class="op">*</span> y0dot</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    t0 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    tmin <span class="op">=</span> gradient_descent(d, t0, <span class="fl">0.01</span>)</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    [dmin, dmindot] <span class="op">=</span> d(tmin)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Minimum bei ("</span>, tmin, dmin, <span class="st">")"</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure()</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.gca()</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim((<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>math.pi))</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim((<span class="dv">0</span>,<span class="dv">6</span>))</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    T <span class="op">=</span> [<span class="dv">2</span><span class="op">*</span>math.pi <span class="op">*</span> k <span class="op">/</span> <span class="dv">1000</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1001</span>)]</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> [d(t)[<span class="dv">0</span>] <span class="cf">for</span> t <span class="kw">in</span> T]  <span class="co"># nur Funktionswert plotten</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    plt.plot(T,Y)</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    plt.xticks([<span class="dv">0</span>, math.pi<span class="op">/</span><span class="dv">2</span>, math.pi, <span class="dv">3</span><span class="op">*</span>math.pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>math.pi],</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>               [<span class="st">'0'</span>, <span class="st">'π/2'</span>, <span class="st">'π'</span>, <span class="st">'3π/2'</span>, <span class="st">'2π'</span>])</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    plt.plot(tmin,dmin,color<span class="op">=</span><span class="st">'r'</span>, marker<span class="op">=</span><span class="st">'o'</span>)</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    plt.show()      </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum bei ( 4.712388977478413 1.5 )</code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fig-mindistproblemsolution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ADOneDimManually_files/figure-html/fig-mindistproblemsolution-output-2.png" width="566" height="409" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;3.2: Kürzester Abstand mit Gradient Descent.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Beachte, dass beim Zeichnen des Funktionsgraphen neu <code>Y = [d(t)[0] for t in T]</code> steht. Der Grund dafür ist, dass <code>d(t)</code> nun eine Liste mit zwei Elementen ist (Funktionswert und Ableitung) und wir nur den Funktionswert zeichnen wollen. Schreibt man stattdessen <code>Y = [d(t) for t in T]</code>, dann wird zusätzlich auch der Graph der Ableitung gezeichnet.</p>
</div>
</div>
</div>
</section>
<section id="sec-SadImplementationOperatorOverloading" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sec-SadImplementationOperatorOverloading"><span class="header-section-number">3.2</span> Implementation der SAD mit Operator Overloading</h2>
<p>Nach dem letzten Abschnitt könnte man einwenden, dass wir die Ableitungen der Funktionen ja doch von Hand berechnet haben, denn wir haben jede Programmzeile, in der eine Variable <code>v</code> berechnet wird, um eine weitere Zeile ergänzt, in der wir <code>vdot</code> nach den bekannten Ableitungsregeln berechnet haben. Dieser Einwand ist auch berechtigt - oder wie es Henrard ausdrückt:</p>
<blockquote class="blockquote">
<p>“The bad news is that it [calculating the derivatives] has to be done; it will not appear magically. It is not only a figure of speech that ‘something has to be done’ but that to have it working everything has to be done”. <span class="citation" data-cites="Henrard2017ADi">(<a href="references.html#ref-Henrard2017ADi" role="doc-biblioref">Henrard 2017, 17</a>)</span></p>
</blockquote>
<p>Die gute Nachricht ist, dass wir diesen Prozess weiter automatisieren können. Wir kennen die Ableitungsregeln für die elementaren Operationen (<code>+,-,*,/</code>), sowie für die Grundfunktionen. In diesem Abschnitt werden wir eine Klasse <code>FloatSad</code> schreiben, deren Instanzen Funktionswerte und Werte der Ableitung speichern. Da solche Werte in der Regel vom Typ <code>float</code> sind und wir die Standard-AD implementieren, nennen wir die Klasse <code>FloatSad</code>. Die Arbeit besteht dann darin, die Ableitungsregeln richtig in den Operatoren dieser Klasse zu kodieren. Da Python <em>Operator Overloading</em> kennt, werden wir dann nach getaner Arbeit die Ableitungen wirklich ohne zusätzlichen Programmieraufwand erhalten.</p>
<p>Der Grundstein für unsere Klasse wurde bereits im 19. Jahrhundert gelegt, wie die folgende Infobox zeigt:</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Hintergrund: Duale Zahlen
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Duale Zahlen wurden 1873 durch William Clifford eingeführt und sind ähnlich definiert, wie komplexe Zahlen. Zur Erinnerung: Eine komplexe Zahl ist eine Zahl der Form <span class="math inline">\(a + bi\)</span>,wobei <span class="math inline">\(a,b \in \mathbb{R}\)</span> sind und <span class="math inline">\(i\)</span> die Eigenschaft <span class="math inline">\(i^2 = -1\)</span> hat. Eine duale Zahl ist eine Zahl der Form <span class="math inline">\(a + a'\epsilon\)</span>, wobei wieder <span class="math inline">\(a,a' \in \mathbb{R}\)</span> gilt, aber <span class="math inline">\(\epsilon\)</span> die Eigenschaft <span class="math inline">\(\epsilon^2 = 0\)</span> hat. Nun kann man nach dem Permanenzprinzip die folgenden Operationen für duale Zahlen definieren:</p>
<p><span class="math display">\[\begin{alignat*}{3}
    &amp;\textrm{Addition:} &amp;&amp; (a+a'\epsilon) + (b+b'\epsilon) &amp;&amp;= (a+b) + (a'+b')\epsilon \\ \\
    &amp;\textrm{Subtraktion:} &amp;&amp; (a+a'\epsilon) - (b+b'\epsilon) &amp;&amp;= (a-b) + (a'-b')\epsilon \\ \\
    &amp;\textrm{Multiplikation:}\quad &amp;&amp; (a+a'\epsilon) \cdot (b+b'\epsilon) &amp;&amp;= ab + a'b\epsilon + ab'\epsilon + a'b'\epsilon^2 \\
    &amp; &amp;&amp; &amp;&amp;= ab + (a'b + ab')\epsilon \\ \\
    &amp;\textrm{Division:} &amp;&amp; (\textrm{für }b\ne 0) \quad \frac{a+a'\epsilon}{b+b'\epsilon} &amp;&amp;= \frac{(a+a'\epsilon)(b-b'\epsilon)}{(b+b'\epsilon)(b-b'\epsilon)} \\
    &amp; &amp;&amp; &amp;&amp;= \frac{ab+a'b\epsilon-ab'\epsilon-a'b'\epsilon^2}{b^2 - (b')^2\epsilon^2} \\
    &amp; &amp;&amp; &amp;&amp;= \frac{ab + (a'b-ab')\epsilon}{b^2} \\
    &amp; &amp;&amp; &amp;&amp;= \frac{a}{b} + \frac{a'b - ab'}{b^2} \epsilon
\end{alignat*}\]</span></p>
<p>Wir sehen, dass der reelle Teil den Wert der Operation und der duale Teil den Wert der zugehörigen Ableitung enthält. Dies gilt auch für Potenzen, wie man unter Anwendung des binomischen Satzes sieht:</p>
<p><span class="math display">\[\begin{align*}
    (a+a'\epsilon)^n &amp;= \sum_{k=0}^n \binom n k a^{n-k} (a'\epsilon)^k  \\
    &amp;= a^n + n \cdot a^{n-1} \cdot a'\epsilon + (\textrm{Terme mit }\epsilon^2) \\
    &amp;= a^n + n \cdot a^{n-1} \cdot a' \epsilon
\end{align*}\]</span></p>
<p>Im dualen Teil erkennen wir die Kettenregel <span class="math inline">\((a^n)' = n\cdot a^{n-1}\cdot a'\)</span>. Damit können wir duale Zahlen auch in Polynome <span class="math inline">\(p(x) = p_0 + p_1 x + p_2 x^2 + \ldots + p_n x^n\)</span> einsetzen. Wir erhalten dann</p>
<p><span class="math display">\[\begin{align*}
    p(a+a'\epsilon) &amp;= p_0 + p_1 (a+a'\epsilon) + p_2 (a+a'\epsilon)^2 + \ldots + p_n (a+a'\epsilon)^n \\
    &amp;= p_0 + p_1 a + p_1 a'\epsilon + p_2 a^2 + p_2 \cdot 2a a' \epsilon + ... + p_n a^n + p_n \cdot n a^{n-1} a' \epsilon \\
    &amp;= p_0 + p_1 a + p_2 a^2 + \ldots p_n a^n + (p_1 + p_2 \cdot 2a + \ldots + p_n \cdot n a^{n-1}) \cdot a' \epsilon \\
    &amp;= p(a) + p'(a) \cdot a'\epsilon
\end{align*}\]</span></p>
<p>Dieses Resultat lässt sich auf allgemeine Funktionen <span class="math inline">\(f\)</span> verallgemeinern (für den Beweis entwickelt man <span class="math inline">\(f\)</span> in eine Taylorreihe und macht die gleichen Überlegungen wie für ein Polynom): <span class="math display">\[
f(a+a'\epsilon) = f(a) + f'(a)\cdot a'\epsilon
\]</span></p>
<p>(<a href="https://en.wikipedia.org/wiki/Dual_number">Wikipedia: Dual number</a> und <span class="citation" data-cites="Slater2022">Slater (<a href="references.html#ref-Slater2022" role="doc-biblioref">2022</a>)</span>)</p>
</div>
</div>
</div>
<section id="sec-FoatSadClassDescription" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sec-FoatSadClassDescription"><span class="header-section-number">3.2.1</span> Die Klasse <code>FloatSad</code></h3>
<p>Beginnen wir nun mit der Implementation unserer Klasse <code>FloatSad</code>. Analog zu den dualen Zahlen enthält jedes <code>FloatSad</code>-Objekt zwei Attribute. Das Attribut <code>value</code> speichert den Funktionswert und das Attribut <code>derivative</code> speichert den Wert der Ableitung. Im Konstruktor der Klasse setzen wir für <code>derivative</code> den Standardwert <code>1</code>. Damit können wir eine gewöhnliche <code>Float</code>-Zahl korrekt in ein <code>FloatSad</code> umwandeln. Dies wird im <code>main</code> Programm demonstriert.</p>
<div class="cell" data-execution_count="12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FloatSad:</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value, derivative <span class="op">=</span> <span class="fl">1.0</span>):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.value <span class="op">=</span> <span class="bu">float</span>(value)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.derivative <span class="op">=</span> derivative</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> FloatSad(x)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> v0</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    resultat <span class="op">=</span> f(x0)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Funktionswert:"</span>, resultat.value)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Ableitung:"</span>, resultat.derivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Funktionswert: 2.0
Ableitung: 1.0</code></pre>
</div>
</div>
<p>In der Funktion <code>f</code> haben wir nun unsere Konvention, dass <code>v0 = x</code> sein soll, dazu verwendet, den Zahlenwert <code>x</code> in ein <code>FloatSad</code>-Objekt umzuwandeln. Die Konvention <code>v0dot = 1</code> ist im Konstruktor kodiert. Von nun an machen wir also die folgende Konvention:</p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Konvention
</div>
</div>
<div class="callout-body-container callout-body">
<p>Eine Funktion berechnet aus einem Argument <code>x</code> vom Typ <code>float</code> oder <code>int</code> einen Rückgabewert <code>y</code> vom Typ <code>FloatSad</code> über eine Reihe von Hilfsvariablen <code>v</code>, die alle vom Typ <code>FloatSad</code> sind. Insbesondere setzen wir am Anfang immer <code>v0 = FloatSad(x)</code>.</p>
</div>
</div>
<p>Das obige Programm berechnet also den Funktionswert und den Wert der Ableitung von <span class="math inline">\(f(x) = x\)</span> an der Stelle <span class="math inline">\(x_0 = 2\)</span>.</p>
<p>Um die Ausgabe etwas einfacher zu gestalten implementieren wir als nächstes die <code>print</code> Methode für unsere Klasse. Wir geben ein <code>FloatSad</code>-Objekt einfach in der Form <code>&lt; value ; derivative &gt;</code> aus.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"&lt; "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.value) <span class="op">+</span> <span class="st">" ; "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.derivative) <span class="op">+</span> <span class="st">" &gt;"</span></span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Da wir nun die Funktion <span class="math inline">\(f(x) = x\)</span> programmieren können, wollen wir als nächstes auch die Funktion <span class="math inline">\(f(x) = -x\)</span> programmieren können. Wir müssen unsere <code>FloatSad</code>-Objekte also mit Vorzeichen versehen.</p>
</section>
<section id="vorzeichen" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="vorzeichen"><span class="header-section-number">3.2.2</span> Vorzeichen</h3>
<p>Natürlich wollen wir nicht nur das negative Vorzeichen, sondern auch das positive Vorzeichen implementieren, damit wir in unseren Programmen z.B. <code>v1 = +v0</code> oder <code>v2 = -v0</code> schreiben können. Beim positiven Vorzeichen müssen wir nichts machen, wir geben also ein <code>FloatSad</code>-Objekt mit den gleichen Attributen zurück. Beim negativen Vorzeichen ändern beide Attribute ihr Vorzeichen.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__pos__</span>(<span class="va">self</span>):</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(<span class="va">self</span>.value, <span class="va">self</span>.derivative)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__neg__</span>(<span class="va">self</span>):</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> <span class="op">-</span><span class="va">self</span>.value</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="op">-</span><span class="va">self</span>.derivative</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun gehen wir daran, die Grundoperationen für <code>FloatSad</code>-Objekte zu implementieren.</p>
</section>
<section id="die-operatoren-und--" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="die-operatoren-und--"><span class="header-section-number">3.2.3</span> Die Operatoren <code>+</code> und <code>-</code></h3>
<p>Wir möchten in unseren Programmen Anweisungen wie <code>v2 = v0 + v1</code> verwenden können. Gemäss der Summenregel können wir dazu einfach die Funktionswerte und auch die Werte der Ableitungen addieren.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__add__</span>(<span class="va">self</span>, other):</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">+</span> other.value</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">+</span> other.derivative</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Nun können wir zwei <code>FloatSad</code>-Objekte miteinander addieren. Manchmal möchten wir aber auch ein <code>float</code>- oder <code>int</code>-Wert zu einem <code>FloatSad</code>-Objekt addieren, z.B. <code>v1 = v0 + 2</code>. Dazu machen wir eine Typabfrage und passen den Wert der Ableitung entsprechend der Konstantenregel an:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__add__</span>(<span class="va">self</span>, other):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">+</span> other</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">+</span> <span class="fl">0.0</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">+</span> other.value</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">+</span> other.derivative</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Jetzt funktioniert zwar die Anweisung <code>v1 = v0 + 2</code>, aber die Anweisung <code>v1 = 2 + v0</code> erzeugt immer noch eine Fehlermeldung. Um dieses Problem zu beheben, müssen wir als nächstes den <em>reverse-add</em>-Operator implementieren.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__radd__</span>(<span class="va">self</span>, other):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other <span class="op">+</span> <span class="va">self</span>.value</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="fl">0.0</span> <span class="op">+</span> <span class="va">self</span>.derivative</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other.value <span class="op">+</span> <span class="va">self</span>.value</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> other.derivative <span class="op">+</span> <span class="va">self</span>.derivative</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hier ist die bisher implementierte Klasse zusammen mit einem kleinen Testprogramm.</p>
<div class="cell" data-execution_count="18">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> FloatSad:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, value, derivative <span class="op">=</span> <span class="fl">1.0</span>):</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.value <span class="op">=</span> <span class="bu">float</span>(value)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.derivative <span class="op">=</span> derivative</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">"&lt; "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.value) <span class="op">+</span> <span class="st">" ; "</span> <span class="op">+</span> <span class="bu">str</span>(<span class="va">self</span>.derivative) <span class="op">+</span> <span class="st">" &gt;"</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># unäre Operatoren</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__pos__</span>(<span class="va">self</span>):</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(<span class="va">self</span>.value, <span class="va">self</span>.derivative)</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__neg__</span>(<span class="va">self</span>):</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="op">-</span><span class="va">self</span>.value</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="op">-</span><span class="va">self</span>.derivative</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># binäre Operatoren</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__add__</span>(<span class="va">self</span>, other):</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>            newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">+</span> other</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>            newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">+</span> <span class="fl">0.0</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>            newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">+</span> other.value</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>            newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">+</span> other.derivative</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__radd__</span>(<span class="va">self</span>, other):</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>            newValue <span class="op">=</span> other <span class="op">+</span> <span class="va">self</span>.value</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>            newDerivative <span class="op">=</span> <span class="fl">0.0</span> <span class="op">+</span> <span class="va">self</span>.derivative</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>            newValue <span class="op">=</span> other.value <span class="op">+</span> <span class="va">self</span>.value</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>            newDerivative <span class="op">=</span> other.derivative <span class="op">+</span> <span class="va">self</span>.derivative</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>        v0 <span class="op">=</span> FloatSad(x)</span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>        v1 <span class="op">=</span> <span class="op">-</span>v0 </span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>        v2 <span class="op">=</span> <span class="dv">3</span> <span class="op">+</span> v1</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>        v3 <span class="op">=</span> v2 <span class="op">+</span> v1</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>        y  <span class="op">=</span> <span class="op">+</span>v3</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>    resultat <span class="op">=</span> f(<span class="dv">2</span>)</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(resultat)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; -1.0 ; -2.0 &gt;</code></pre>
</div>
</div>
<div id="exr-verifyFirstSADderivative" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.8 (Korrektheit überprüfen) </strong></span><br></p>
<p>Welche Funktion berechnet <code>f</code> im <code>main</code> Programm? Stimmt die Ausgabe?</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Es handelt sich um die Funktion <span class="math inline">\(f(x) = 3 - 2x\)</span>. Die Ausgabe <span class="math inline">\(f(2) = -1, f'(2) = -2\)</span> ist also korrekt.</p>
</div>
</div>
</div>
<p>Für die nächste Übung musst du das obige Programm kopieren und in einer Datei mit dem Namen <code>floatsad.py</code> abspeichern. Speichere die Datei im gleichen Ordner wie die anderen Dateien.</p>
<div id="exr-ImplementSub" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.9 (Den Operator <code>-</code> implementieren) </strong></span><br></p>
<p>Implementiere auf die gleiche Weise den <code>-</code>-Operator. Die Methoden lauten <code>__sub__(self, other)</code> bzw. <code>__rsub__(self, other)</code>. Schreibe auch eine Testfunktion <code>f</code>, welche die neuen Operatoren verwendet.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__sub__</span>(<span class="va">self</span>, other):</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">-</span> other</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">-</span> <span class="fl">0.0</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">-</span> other.value</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">-</span> other.derivative</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__rsub__</span>(<span class="va">self</span>, other):</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other <span class="op">-</span> <span class="va">self</span>.value</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="fl">0.0</span> <span class="op">-</span> <span class="va">self</span>.derivative</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other.value <span class="op">-</span> <span class="va">self</span>.value</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> other.derivative <span class="op">-</span> <span class="va">self</span>.derivative</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="die-operatoren-und" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="die-operatoren-und"><span class="header-section-number">3.2.4</span> Die Operatoren <code>*</code> und <code>/</code></h3>
<p>Als nächstes wollen wir die Multiplikation implementieren, um Anweisungen der Form <code>v2 = v0 * v1</code> ausführen zu können. Dazu müssen wir die Produktregel verwenden. Wie bei der Addition und der Subtraktion soll unser <code>*</code>-Operator aber auch Anweisungen der Form <code>v1 = v0 * 2</code> oder <code>v1 = -3 * v0</code> richtig auswerten, bei denen die Faktorregel angewendet wird. Dazu ist wieder eine Typabfrage nötig.</p>
<div id="exr-ImplementMul" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.10 (Den Operator <code>*</code> implementieren) </strong></span><br></p>
<p>Ergänze die Datei <code>floatsad.py</code> mit den Methoden <code>__mul__(self, other)</code> und <code>__rmul__(self, other)</code>. Überlege dir verschiedene Testfälle und überzeuge dich von der Korrektheit deines Programms.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__mul__</span>(<span class="va">self</span>, other):</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">*</span> other</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">*</span> other</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">*</span> other.value</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">*</span> other.value <span class="op">+</span> <span class="va">self</span>.value <span class="op">*</span> other.derivative</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__rmul__</span>(<span class="va">self</span>, other):</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other <span class="op">*</span> <span class="va">self</span>.value</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> other <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other.value <span class="op">*</span> <span class="va">self</span>.value</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span>  other.derivative <span class="op">*</span> <span class="va">self</span>.value <span class="op">+</span> other.value <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Es fehlt noch der Divisionsoperator, damit wir Anweisungen wie <code>v2 = v1 / v0</code> verwenden können. Da wir es bei differenzierbaren Funktionen immer mit <code>float</code>- bzw. <code>FloatSad</code>-Objekten zu tun haben, implementieren wir nur den <code>/</code>-Operator, also die Funktion <code>__truediv__(self, other)</code> und nicht den <code>//</code>-Operator. Wir wollen aber wieder die Fallunterscheidung nach den Typen machen, so dass auch Anweisungen wie <code>v1 = v0 / 4</code> verwendet werden können. Dabei benötigen wir nur die Faktorregel und nicht die Quotientenregel. Um schliesslich auch noch <code>v1 = -4 / v0</code> zu ermöglichen, muss noch <code>__rtruediv__(self, other)</code> implementiert werden. Bei letzterem darf nicht vergessen werden, dass auch die Kettenregel benutzt werden muss, denn <span class="math inline">\(\frac{dv_1}{dx} = \frac{dv_1}{dv_0}\cdot \frac{dv_0}{dx} = \frac{4}{v_0^2}\cdot v_0'\)</span>. Quadrate kann man mit <code>math.pow(value, 2)</code> berechnen. Bei der Implementierung müssen wir uns übrigens nicht um Fehlerbehandlungen, wie das Abfangen einer Division durch Null, kümmern, weil diese bereits im <code>/</code>-Operator, den wir verwenden, implementiert sind.</p>
<div id="exr-ImplementTrueDiv" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.11 (Den Operator <code>/</code> implementieren) </strong></span><br></p>
<p>Ergänze die Datei <code>floatsad.py</code> mit den Methoden <code>__truediv__(self, other)</code> und <code>__rtruediv__(self, other)</code>. Überlege dir auch wieder verschiedene Testfälle und überzeuge dich von der Korrektheit deines Programms.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__truediv__</span>(<span class="va">self</span>, other):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">/</span> other</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="va">self</span>.derivative <span class="op">/</span> other</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> <span class="va">self</span>.value <span class="op">/</span> other.value</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> (<span class="va">self</span>.derivative <span class="op">*</span> other.value <span class="op">-</span> <span class="va">self</span>.value <span class="op">*</span> other.derivative) <span class="op">/</span> math.<span class="bu">pow</span>(other.value, <span class="dv">2</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__rtruediv__</span>(<span class="va">self</span>, other):</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other <span class="op">/</span> <span class="va">self</span>.value</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="op">-</span> other <span class="op">/</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, <span class="dv">2</span>) <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> other.value <span class="op">/</span> <span class="va">self</span>.value</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> (other.derivative <span class="op">*</span> <span class="va">self</span>.value <span class="op">-</span> other.value <span class="op">*</span> <span class="va">self</span>.derivative) <span class="op">/</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, <span class="dv">2</span>) <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="der-operator" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="der-operator"><span class="header-section-number">3.2.5</span> Der Operator <code>**</code></h3>
<p>Interessant ist nun die Implementation des Potenzoperators. Hier sind mehrere Fallunterscheidungen nötig.</p>
<p>Betrachten wir zuerst den Fall, <code>type(other) in (float, int)</code>, d.h. wir haben einen Ausdruck der Form <code>v1 = v0 ** 3</code>. In diesem Fall wenden wir die Potenzregel zusammen mit der Kettenregel an.</p>
<p>Im zweiten Fall haben wir einen Ausdruck wie <code>v3 = v1 ** v2</code>. Wir müssen uns also zuerst überlegen, wie wir einen Ausdruck der Form <span class="math inline">\(v_3 (x) = v_1(x) ^{v_2 (x)}\)</span> überhaupt ableiten. Offenbar muss dazu <span class="math inline">\(v_1(x) &gt; 0\)</span> gelten. Um die Ableitung zu finden wenden wir den Trick an, dass wir die Funktion zuerst logarithmieren, <span class="math display">\[
\ln(v_3(x)) = \ln(v_1(x) ^{v_2 (x)}) = v_2(x) \cdot \ln(v_1(x))
\]</span> und danach beide Seiten ableiten, wobei wir auf der rechten Seite die Produktregel anwenden: <span class="math display">\[
\frac{d}{dx}(\ln(v_3(x))) = v_2'(x) \cdot \ln(v_1(x)) + v_2(x) \cdot \frac{1}{v_1(x)} \cdot v_1'(x)
\]</span> Die linke Seite ergibt andererseits <span class="math inline">\(\frac{d}{dx}(\ln(v_3(x))) = \frac{1}{v_3(x)}\cdot v_3'(x)\)</span>, so dass wir nun nach <span class="math inline">\(v_3'(x)\)</span> auflösen können:</p>
<p><span class="math display">\[\begin{align*}
    v_3'(x) &amp;= v_3(x) \cdot \left( v_2'(x) \cdot \ln(v_1(x)) + \frac{v_2(x)}{v_1(x)} \cdot v_1'(x) \right) \\
    &amp;= v_1(x) ^{v_2 (x)} \cdot \left( \ln(v_1(x)) \cdot v_2'(x) + \frac{v_2(x)}{v_1(x)} \cdot v_1'(x) \right)
\end{align*}\]</span></p>
<p>Auch hier sind alle nötigen Fehlerbehandlungen bereits in <code>math.pow</code> implementiert.</p>
<div id="exr-ImplementPow" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.12 (Den Operator <code>**</code> implementieren - Teil 1) </strong></span><br></p>
<p>Ergänze die Datei <code>floatsad.py</code> mit der Methode <code>__pow__(self, other)</code>. Dabei übernimmt <code>self</code> die Rolle von <span class="math inline">\(v_1\)</span> in der obigen Herleitung und <code>other</code> entspricht <span class="math inline">\(v_2\)</span>. Die Funktion <span class="math inline">\(\ln(\ldots)\)</span> heisst in Python <code>math.log()</code>. Teste dein Programm an verschiedenen Funktionen.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__pow__</span>(<span class="va">self</span>, other):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, other)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> other <span class="op">*</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, other <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, other.value)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> math.<span class="bu">pow</span>(<span class="va">self</span>.value, other.value) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>            (other.derivative <span class="op">*</span> math.log(<span class="va">self</span>.value) <span class="op">+</span> other.value <span class="op">*</span> <span class="va">self</span>.derivative <span class="op">/</span> <span class="va">self</span>.value)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Nun implementieren wir auch noch die Methode <code>__rpow__(self, other)</code>. Im Fall, dass <code>type(other) in (float, int)</code> ist, handelt es sich hierbei um eine Exponentialfunktion. <code>math.pow</code> stellt dann sicher, dass die Basis, also <code>other</code>, eine positive Zahl ist. Falls <code>other</code> ebenfalls ein <code>FloatSad</code> ist, dann kann die Ableitung gleich wie oben berechnet werden, ausser, dass jetzt <code>self</code> und <code>other</code> ihre Rollen tauschen.</p>
<div id="exr-ImplementRpow" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.13 (Den Operator <code>**</code> implementieren - Teil 2) </strong></span><br></p>
<p>Ergänze die Datei <code>floatsad.py</code> mit der Methode <code>__rpow__(self, other)</code>. Teste dein Programm an verschiedenen Funktionen.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__rpow__</span>(<span class="va">self</span>, other):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.<span class="bu">pow</span>(other, <span class="va">self</span>.value)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> math.<span class="bu">pow</span>(other, <span class="va">self</span>.value) <span class="op">*</span> math.log(other) <span class="op">*</span> <span class="va">self</span>.derivative</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.<span class="bu">pow</span>(other.value, <span class="va">self</span>.value)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> math.<span class="bu">pow</span>(other.value, <span class="va">self</span>.value) <span class="op">*</span> <span class="op">\</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>            (<span class="va">self</span>.derivative <span class="op">*</span> math.log(other.value) <span class="op">+</span> <span class="va">self</span>.value <span class="op">*</span> other.derivative <span class="op">/</span> other.value)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="vergleichsopertoren" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="vergleichsopertoren"><span class="header-section-number">3.2.6</span> Vergleichsopertoren</h3>
<p>Es könnte sein, dass wir <code>FloatSad</code>-Objekte auch miteinander vergleichen wollen, also eine der Abfragen aus <a href="#tbl-Vergleichsmethoden">Tabelle&nbsp;<span>3.1</span></a> machen wollen.</p>
<div id="tbl-Vergleichsmethoden" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;3.1: Vergleichsoperatoren</caption>
<thead>
<tr class="header">
<th>Operator</th>
<th>Methode</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>&lt;</code></td>
<td><code>__lt__(self, other)</code></td>
</tr>
<tr class="even">
<td><code>&lt;=</code></td>
<td><code>__le__(self, other)</code></td>
</tr>
<tr class="odd">
<td><code>==</code></td>
<td><code>__eq__(self, other)</code></td>
</tr>
<tr class="even">
<td><code>!=</code></td>
<td><code>__ne__(self, other)</code></td>
</tr>
<tr class="odd">
<td><code>&gt;</code></td>
<td><code>__gt__(self, other)</code></td>
</tr>
<tr class="even">
<td><code>&gt;=</code></td>
<td><code>__ge__(self, other)</code></td>
</tr>
</tbody>
</table>
</div>
<p>Dazu vergleichen wir jeweils nur die Funktionswerte. Die Implementation sieht dann folgendermassen aus:</p>
<div class="cell" data-execution_count="24">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vergleichsoperatoren </span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__lt__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;</span> other</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;</span> other.value</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__le__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;=</span> other</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&lt;=</span> other.value</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__eq__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">==</span> other</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">==</span> other.value</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__ne__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">!=</span> other</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">!=</span> other.value</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__gt__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;</span> other</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;</span> other.value</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> <span class="fu">__ge__</span>(<span class="va">self</span>, other):</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(other) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;=</span> other</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.value <span class="op">&gt;=</span> other.value</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="die-klasse-floatsad-im-einsatz" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="die-klasse-floatsad-im-einsatz"><span class="header-section-number">3.3</span> Die Klasse <code>FloatSad</code> im Einsatz</h2>
<p>Falls im letzten Abschnitt etwas nicht geklappt haben sollte, kann die fertige Klasse <code>FloatSad</code> von <a href="floatsad.py">hier</a> kopiert werden.</p>
<p>Um unsere Klasse zu verwenden müssen wir sie jeweils am Anfang mit</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>einbinden.</p>
<div id="exm-FloatSadUsage1" class="theorem example">
<p><span class="theorem-title"><strong>Beispiel 3.1 (Ein Programm mit FloatSad) </strong></span><br></p>
<p>Betrachte die Funktion aus <a href="intro.html#exm-FirstFunctionAsProgram">Beispiel&nbsp;<span>1.1</span></a>. Wir übernehmen das Programm und passen lediglich die erste Zeile der Funktion gemäss der Konvention aus <a href="#sec-FoatSadClassDescription"><span>Kapitel&nbsp;3.2.1</span></a> an.</p>
<div class="cell" data-execution_count="27">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    v0 <span class="op">=</span> FloatSad(x)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    v1 <span class="op">=</span> <span class="dv">2</span> <span class="op">+</span> v0</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    v2 <span class="op">=</span> v0 <span class="op">-</span> <span class="dv">3</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> v1 <span class="op">*</span> v2</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; -4.0 ; 3.0 &gt;</code></pre>
</div>
</div>
<p>Da nun alle Ableitungsregeln in den verwendeten Operatoren integriert sind, können wir nun sogar auf die Zwischenschritte mit den <code>v</code> verzichten:</p>
<div class="cell" data-execution_count="28">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> FloatSad(x)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> (<span class="dv">2</span><span class="op">+</span>x) <span class="op">*</span> (x<span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; -4.0 ; 3.0 &gt;</code></pre>
</div>
</div>
</div>
<hr>
<p>Wir sehen, dass wir also alle unsere Konventionen, die dazu dienten, komplizierte Funktionsausdrücke in ihre Bestandteile zu zerlegen und diese mit den elementaren Ableitungsregeln zu differenzieren, wieder aufgeben können! Der einzige Zusatzaufwand, den wir bei der Programmierung haben, ist das Umwandeln des Arguments <code>x</code> in ein <code>FloatSad</code>-Objekt.</p>
<div id="exr-FloatSadAnwenden1" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.14 (<code>FloatSad</code> anwenden) </strong></span><br></p>
<p>Vereinfache die Lösung von <a href="#exr-SADmitSchleife">Übungsaufgabe&nbsp;<span>3.5</span></a> mit Hilfe der Klasse <code>FloatSad</code>. Überzeuge dich davon, dass die Ableitungen auch für Programme mit Schleifen korrekt berechnet werden.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="29">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> l(x):</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> FloatSad(x)</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> l(x)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(<span class="dv">1</span>))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; 26.0 ; 80.0 &gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="das-modul-mathsad" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="das-modul-mathsad"><span class="header-section-number">3.4</span> Das Modul <code>mathsad</code></h2>
<p>Mit der Klasse <code>FloatSad</code> können wir Funktionswerte und Ableitungen von algebraischen Funktionen bilden. Wir können aber unsere <code>FloatSad</code>-Objekte noch nicht mit den Funktionen aus dem Python-Modul <code>math</code> verwenden, z.B. mit <code>exp</code> oder <code>sin</code>. In diesem Abschnitt wollen wir ein eigenes Modul <code>mathsad</code> schreiben, in dem wir die Funktionen aus <a href="#tbl-mathFunctions">Tabelle&nbsp;<span>3.2</span></a> so implementieren, dass wir sie auf <code>FloatSad</code>-Objekte anwenden können.</p>
<div id="tbl-mathFunctions" class="anchored">
<table class="table">
<caption>Tabelle&nbsp;3.2: Funktionen des Moduls <code>math</code> (Auswahl)</caption>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>sqrt</code></td>
<td style="text-align: center;"><code>exp</code></td>
<td style="text-align: center;"><code>log</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sin</code></td>
<td style="text-align: center;"><code>cos</code></td>
<td style="text-align: center;"><code>tan</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>asin</code></td>
<td style="text-align: center;"><code>acos</code></td>
<td style="text-align: center;"><code>atan</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>sinh</code></td>
<td style="text-align: center;"><code>cosh</code></td>
<td style="text-align: center;"><code>tanh</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>asinh</code></td>
<td style="text-align: center;"><code>acosh</code></td>
<td style="text-align: center;"><code>atanh</code></td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>fabs</code></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</div>
<p>Gemäss der <a href="https://docs.python.org/3.8/library/math.html">Python-Dokumentation</a> liefert die Funktion <code>math.exp(x)</code> präzisere Werte als <code>math.e ** x</code> oder <code>math.pow(math.e, x)</code>. Die Funktion <code>math.log(x)</code> berechnet den Logarithmus zur Basis <span class="math inline">\(e\)</span>, man kann ihr aber als zweites Argument auch eine andere Basis übergeben, z.B. <code>math.log(x,b)</code>, was dann mit <code>math.log(x)/math.log(b)</code> berechnet wird. Die Funktion <code>math.fabs(x)</code> schliesslich berechnet den Absolutbetrag <span class="math inline">\(|x|\)</span>. Ihre Ableitung ist</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(math.fabs(v)).derivative <span class="op">=</span> v.derivative <span class="cf">if</span> v<span class="op">&gt;=</span><span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span>v.derivative</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Funktion <span class="math inline">\(y=|x|\)</span> ist an der Stelle <span class="math inline">\(x=0\)</span> eigentlich nicht differenzierbar. Da wir aber nicht Ableitungsfunktionen, sondern nur Werte von Ableitungen an einer bestimmten Stelle berechnen, reicht es, den rechts- oder linksseitigen Grenzwert zurückzugeben, siehe <span class="citation" data-cites="Gander1992">Gander (<a href="references.html#ref-Gander1992" role="doc-biblioref">1992</a>)</span>. Wir müssen es dem Benutzer überlassen, das Ergebnis im jeweiligen Kontext korrekt zu interpretieren.</p>
<section id="die-funktion-sqrt" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="die-funktion-sqrt"><span class="header-section-number">3.4.1</span> Die Funktion <code>sqrt</code></h3>
<p>Beginnen wir mit der Implementierung der Wurzelfunktion.</p>
<div class="cell" data-execution_count="31">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sqrt(x):</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.sqrt(x.value)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>math.sqrt(x.value)) <span class="op">*</span> x.derivative</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> FloatSad(x)</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>        y <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> sqrt(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> y</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>    x0 <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; 0.7071067811865475 ; 0.3535533905932737 &gt;</code></pre>
</div>
</div>
<p>Wir gehen davon aus, dass <code>x</code> ein <code>FloatSad</code>-Objekt ist. Für den Wert von <code>sqrt(x)</code> verwenden wir einfach die Funktion <code>math.sqrt</code>. Diese enthält auch die nötige Fehlerbehandlung. Zusätzlich berechnen wir aber noch den Wert der Ableitung mit Hilfe der bekannten Ableitungsregel und wie zuvor wenden wir immer die Kettenregel an. Das Programm enthält auch ein Testprogramm, welches die Ableitung der Funktion <span class="math inline">\(f(x) = \frac{1}{\sqrt{x^2+1}}\)</span> an der Stelle <span class="math inline">\(x_0 = -1\)</span> berechnet. Zur Kontrolle kann die GeoGebra-Vorlage zu Beginn von <a href="#sec-SadManualImplementation"><span>Kapitel&nbsp;3.1</span></a> verwendet werden.</p>
</section>
<section id="die-funktionen-exp-und-log" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="die-funktionen-exp-und-log"><span class="header-section-number">3.4.2</span> Die Funktionen <code>exp</code> und <code>log</code></h3>
<div id="exr-implementExp" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.15 (Exponentialfunktion) </strong></span><br></p>
<p>Kopiere den obigen Code und speichere ihn in einer Datei mit dem Namen <code>mathsad.py</code>. Speichere die Datei im gleichen Ordner wie die anderen Dateien. Ergänze die Datei danach mit der Funktion <code>exp</code>. Wähle eine neue Testfunktion im <code>main</code>, um dich von der Richtigkeit deiner Lösung zu überzeugen.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> exp(x):</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.exp(x.value)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> math.exp(x.value) <span class="op">*</span> x.derivative</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Für die Logarithmusfunktion müssen wir uns wieder etwas mehr Gedanken machen. Mit <code>def log(x, b = math.e)</code> kann man der Basis <span class="math inline">\(b\)</span> wie oben beschrieben den Standardwert <span class="math inline">\(b=e\)</span> geben. Solange <code>b</code> vom Typ <code>int</code> oder <code>float</code> ist, kann man einfach die bekannte Ableitungsregel anwenden. Wenn aber <code>b</code> ein <code>FloatSad</code>-Objekt ist, wie z.B. in <code>v3 = math.log(v1, v2)</code>, dann müssen wir den Basiswechselsatz <span class="math display">\[
v_3(x) = \log_{v_2(x)}(v_1(x)) = \frac{\ln(v_1(x))}{\ln(v_2(x))}
\]</span> verwenden und mit der Quotientenregel ableiten.</p>
<div id="exr-implementLog" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.16 (Logarithmusfunktion) </strong></span><br></p>
<p>Überlege dir, wie die Ableitung von <span class="math inline">\(v_3(x)\)</span> aussieht. Ergänze danach die Datei <code>mathsad.py</code> mit der Implementation der Logarithmusfunktion. Überzeuge dich mit einer Testfunktion von der Richtigkeit deines Programms.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Die Ableitung lautet <span class="math display">\[
\frac{d}{dx}v_3(x) = \frac{\frac{v_1'(x)}{v_1(x)}\cdot \ln(v_2(x))-\ln(v_1(x))\cdot\frac{v_2'(x)}{v_2(x)}}{\ln^2(v_2(x))}
\]</span></p>
<div class="cell" data-execution_count="33">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> log(x, b <span class="op">=</span> math.e):</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">type</span>(b) <span class="kw">in</span> (<span class="bu">float</span>, <span class="bu">int</span>):</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.log(x.value, b)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (x.value <span class="op">*</span> math.log(b)) <span class="op">*</span> x.derivative</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        newValue <span class="op">=</span> math.log(x.value, b.value)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        newDerivative <span class="op">=</span> (x.derivative<span class="op">/</span>x.value <span class="op">*</span> math.log(b.value) <span class="op">-</span> math.log(x.value) <span class="op">*</span> b.derivative <span class="op">/</span> b.value) <span class="op">\</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">/</span> math.<span class="bu">pow</span>(math.log(b.value), <span class="dv">2</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="die-trigonometrischen-funktionen-und-ihre-umkehrfunktionen" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="die-trigonometrischen-funktionen-und-ihre-umkehrfunktionen"><span class="header-section-number">3.4.3</span> Die trigonometrischen Funktionen und ihre Umkehrfunktionen</h3>
<p>Bei den trigonometrischen Funktionen und den Arcus Funktionen können wir einfach die bekannten Ableitungsregeln verwenden.</p>
<div id="exr-implementTrig" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.17 (Trigonometrische Funktionen) </strong></span><br></p>
<p>Ergänze die Datei <code>mathsad.py</code> mit den Funktionen <code>sin</code>, <code>cos</code> und <code>tan</code>, sowie den Funktionen <code>asin</code>, <code>acos</code> und <code>atan</code>.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Beachte, dass man für <code>tan</code> einfach <span class="math inline">\(\tan(x)=\frac{\sin(x)}{\cos(x)}\)</span> verwenden kann, wenn <code>sin</code> und <code>cos</code> bereits implementiert sind.</p>
<div class="cell" data-execution_count="34">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sin(x):</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.sin(x.value)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> math.cos(x.value) <span class="op">*</span> x.derivative</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cos(x):</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.cos(x.value)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="op">-</span>math.sin(x.value) <span class="op">*</span> x.derivative</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tan(x):</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sin(x) <span class="op">/</span> cos(x)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> asin(x):</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.asin(x.value)</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>math.sqrt( <span class="dv">1</span> <span class="op">-</span> math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>)) <span class="op">*</span> x.derivative</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acos(x):</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.acos(x.value)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">/</span>math.sqrt( <span class="dv">1</span> <span class="op">-</span> math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>)) <span class="op">*</span> x.derivative</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> atan(x):</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.atan(x.value)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> x.derivative</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative) </span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="die-hyperbolischen-funktionen-und-ihre-umkehrfunktionen" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="die-hyperbolischen-funktionen-und-ihre-umkehrfunktionen"><span class="header-section-number">3.4.4</span> Die hyperbolischen Funktionen und ihre Umkehrfunktionen</h3>
<p>Auch bei den hyperbolischen Funktionen und den Area Funktionen verwenden wir die bekannten Ableitungsregeln.</p>
<div id="exr-implementHyp" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.18 (Hyperbolische Funktionen) </strong></span><br></p>
<p>Ergänze die Datei <code>mathsad.py</code> mit den Funktionen <code>sinh</code>, <code>cosh</code> und <code>tanh</code>, sowie den Funktionen <code>asinh</code>, <code>acosh</code> und <code>atanh</code>.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Wie bei den trigonometrischen Funktionen gilt auch hier <span class="math inline">\(\tanh(x)=\frac{\sinh(x)}{\cosh(x)}\)</span>.</p>
<div class="cell" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sinh(x):</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.sinh(x.value)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> math.cosh(x.value) <span class="op">*</span> x.derivative</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cosh(x):</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.cosh(x.value)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> math.sinh(x.value) <span class="op">*</span> x.derivative</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tanh(x):</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sinh(x) <span class="op">/</span> cosh(x)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> asinh(x):</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.asinh(x.value)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>math.sqrt(math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> x.derivative</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> acosh(x):</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.acosh(x.value)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>math.sqrt(math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> x.derivative</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> atanh(x):</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.atanh(x.value)</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> <span class="op">-</span><span class="dv">1</span><span class="op">/</span>(math.<span class="bu">pow</span>(x.value, <span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> x.derivative</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="die-betragsfunktion" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="die-betragsfunktion"><span class="header-section-number">3.4.5</span> Die Betragsfunktion</h3>
<p>Schliesslich ergänzen wir die Datei <code>mathsad.py</code> noch mit der Funktion <code>fabs</code> wie oben beschrieben:</p>
<div class="cell" data-execution_count="36">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fabs(x):</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    newValue <span class="op">=</span> math.fabs(x.value)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>    newDerivative <span class="op">=</span> x.derivative <span class="cf">if</span> x<span class="op">&gt;=</span><span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span>x.derivative</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> FloatSad(newValue, newDerivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Das fertige Modul kann auch von <a href="mathsad.py">hier</a> kopiert werden.</p>
</section>
</section>
<section id="das-modul-mathsad-im-einsatz" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="das-modul-mathsad-im-einsatz"><span class="header-section-number">3.5</span> Das Modul <code>mathsad</code> im Einsatz</h2>
<p></p>
<p>Nun können wir unser Modul mit</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mathsad</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>einbinden und verwenden. Die Funktion aus <a href="#exr-SAD1">Übungsaufgabe&nbsp;<span>3.3</span></a> beispielsweise können wir nun direkt hinschreiben:</p>
<div class="cell" data-execution_count="38">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mathsad</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> FloatSad(x)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> mathsad.cos(x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span>) <span class="op">*</span> mathsad.exp(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span> x<span class="op">**</span><span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>x</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> <span class="op">-</span><span class="dv">2</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f(x0))</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt; -0.3700550823007931 ; -0.14136926695938976 &gt;</code></pre>
</div>
</div>
<div id="exr-mathsadAnwenden" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.19 (Verwendung von <code>mathsad</code>) </strong></span><br></p>
<p>Verwende das Modul <code>mathsad</code>, um die Lösung von <a href="#exr-SAD2">Übungsaufgabe&nbsp;<span>3.4</span></a> zu vereinfachen. Bestimme die Ableitung von <span class="math inline">\(f\)</span> an der Stelle <span class="math inline">\(x_0=\sqrt{2}\)</span>.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="39">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mathsad</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> FloatSad(x)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    u <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> mathsad.log(u) <span class="op">/</span> mathsad.sqrt(u <span class="op">+</span> x)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>x0 <span class="op">=</span> math.sqrt(<span class="dv">2</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>f0 <span class="op">=</span> f(x0)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f0.derivative)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.22198842685304976</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="exr-billardMathsadSolutions" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.20 (Billard-Problem mit <code>mathsad</code>) </strong></span><br></p>
<p>Verwende das Modul <code>mathsad</code>, um die Lösung des Billard-Problems aus <a href="#exr-BillardSADmanualSOlution">Übungsaufgabe&nbsp;<span>3.6</span></a> zu vereinfachen. Programmiere dazu nochmals die Funktion <code>f(x)</code>, aber verwende aussagekräfigere Variablen. Weil <code>f</code> nun <code>FloatSad</code>-Objekte zurückgibt, muss auch die Funktion <code>newton(f, x0)</code> angepasst werden. Die Funktion <code>main</code> kann aus der obigen Lösung kopiert werden.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In der Funktion <code>newton(f, x0)</code> muss lediglich die Berechnung des neuen Näherungswertes angepasst werden durch <code>x1 = x0 - y0.value / y0.derivative</code>.</p>
<div class="cell" data-execution_count="40">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mathsad</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameter a, px, py werden im global space gefunden</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> FloatSad(x)</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    Xx, Xy <span class="op">=</span> mathsad.cos(x), mathsad.sin(x) <span class="co"># Koordinaten von X</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    tx, ty <span class="op">=</span> <span class="op">-</span>Xy, Xx                        <span class="co"># Komponenten des Tangentialvektors</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    XPx, XPy <span class="op">=</span> px <span class="op">-</span> Xx, py <span class="op">-</span> Xy             <span class="co"># Komponenten des Vektors XP</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    lXP <span class="op">=</span> mathsad.sqrt(XPx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> XPy<span class="op">**</span><span class="dv">2</span>)     <span class="co"># Länge des Vektors XP</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    ePx, ePy <span class="op">=</span> XPx <span class="op">/</span> lXP, XPy <span class="op">/</span> lXP         <span class="co"># Komponenten des Einheitsvektors in Richtung XP</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    XQx, XQy <span class="op">=</span> a <span class="op">-</span> Xx, <span class="op">-</span>Xy                  <span class="co"># Komponenten des Vektors XQ</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>    lXQ <span class="op">=</span> mathsad.sqrt(XQx<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> XQy<span class="op">**</span><span class="dv">2</span>)     <span class="co"># Länge des Vektors XQ</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    eQx, eQy <span class="op">=</span> XQx <span class="op">/</span> lXQ, XQy <span class="op">/</span> lXQ         <span class="co"># Komponenten des Einheitsvektors in Richtung XQ</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> (ePx <span class="op">+</span> eQx) <span class="op">*</span> tx <span class="op">+</span> (ePy <span class="op">+</span> eQy) <span class="op">*</span> ty <span class="co"># Skalarprodukt</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> newton(f, x0):</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="fl">1e-8</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    y0 <span class="op">=</span> f(x0)</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> x0 <span class="op">-</span> y0.value <span class="op">/</span> y0.derivative</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> math.fabs(x1 <span class="op">-</span> x0) <span class="op">&gt;</span> tol:</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>        y0 <span class="op">=</span> f(x0)</span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0 <span class="op">-</span> y0.value <span class="op">/</span> y0.derivative</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Parameter definieren</span></span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>          <span class="co"># Position von Q = (a|0)</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>    px, py <span class="op">=</span> <span class="fl">0.2</span>, <span class="fl">0.6</span> <span class="co"># Position von P = (px|py)</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lösung des Billardproblems berechnen</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>    sol <span class="op">=</span> <span class="bu">set</span>({}) <span class="co"># leere Menge, in der die gefundenen Lösungen gespeichert werden</span></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> [<span class="dv">2</span><span class="op">*</span>math.pi <span class="op">*</span> k <span class="op">/</span> <span class="dv">10</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]  <span class="co"># Liste der Startwerte für Newton</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x0 <span class="kw">in</span> X:</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> newton(f, x0)</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>        sol.add(x)</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Lösungen grafisch darstellen</span></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure()</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.gca()</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim((<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>))</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim((<span class="op">-</span><span class="fl">1.2</span>, <span class="fl">1.2</span>))</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>    circle <span class="op">=</span> plt.Circle((<span class="dv">0</span>,<span class="dv">0</span>), <span class="dv">1</span>, color<span class="op">=</span><span class="st">'b'</span>, fill<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>    qBall <span class="op">=</span> plt.Circle((a,<span class="dv">0</span>), <span class="fl">0.02</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>    pBall <span class="op">=</span> plt.Circle([px, py], <span class="fl">0.02</span>, color<span class="op">=</span><span class="st">'k'</span>)</span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(circle)</span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(qBall)</span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>    ax.add_patch(pBall)</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> sol:</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>        xcoords <span class="op">=</span> [a, math.cos(x), px]</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>        ycoords <span class="op">=</span> [<span class="dv">0</span>, math.sin(x), py]</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a>        plt.plot(xcoords, ycoords, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>    plt.show()</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div id="fig-billardproblemsolutionwithmathsad" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ADOneDimManually_files/figure-html/fig-billardproblemsolutionwithmathsad-output-1.png" width="423" height="404" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;3.3: Lösung des Billardproblems mit anderen Startwerten.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="exr-minDistSolutionWithSAD" class="theorem exercise">
<p><span class="theorem-title"><strong>Übungsaufgabe 3.21 (Kürzeste Distanz mit <code>mathsad</code>) </strong></span><br></p>
<p>Verwende das Modul <code>mathsad</code>, um die Lösung von <a href="#exr-MinDistlSolution">Übungsaufgabe&nbsp;<span>3.7</span></a> zu vereinfachen. Weil <code>d</code> nun <code>FloatSad</code>-Objekte zurückgibt, muss auch die Funktion <code>gradient_descent(f, x0, lam)</code> angepasst werden.</p>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Lösung
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In der Funktion <code>gradient_descent(f, x0, lam)</code> muss lediglich die Berechnung des neuen Näherungswertes angepasst werden. Statt des Graphen wird hier nur das globale Minimum als Punkt ausgegeben.</p>
<div id="fig-mindistsolutionwithmathsad" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> floatsad <span class="im">import</span> FloatSad</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mathsad</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> d(t):</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> FloatSad(t)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    Px <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> mathsad.cos(t) <span class="op">-</span> <span class="dv">1</span>    <span class="co"># x-Koordinate von P</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    Py <span class="op">=</span> <span class="fl">1.5</span> <span class="op">*</span> mathsad.sin(t)      <span class="co"># y-Koordinate von P</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    Pz <span class="op">=</span> <span class="dv">0</span>                         <span class="co"># z-Koordinate von P</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    Qx <span class="op">=</span> <span class="op">-</span><span class="dv">3</span> <span class="op">*</span> mathsad.sin(<span class="dv">2</span><span class="op">*</span>t)     <span class="co"># x-Koordinate von Q</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    Qy <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> mathsad.cos(<span class="dv">2</span><span class="op">*</span>t) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># y-Koordinate von Q</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    Qz <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> mathsad.sin(<span class="dv">2</span><span class="op">*</span>t) <span class="op">+</span> <span class="dv">1</span>  <span class="co"># z-Koordinate von Q</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> mathsad.sqrt((Px<span class="op">-</span>Qx)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Py<span class="op">-</span>Qy)<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> (Pz<span class="op">-</span>Qz)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gradient_descent(f, x0, lam):</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    tol <span class="op">=</span> <span class="fl">1e-9</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Erster Schritt berechnen</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    y0 <span class="op">=</span> f(x0)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    x1 <span class="op">=</span> x0 <span class="op">-</span> lam <span class="op">*</span> y0.derivative</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> math.fabs(x1<span class="op">-</span>x0) <span class="op">&gt;</span> tol:</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> x1</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        y0 <span class="op">=</span> f(x0)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> x0 <span class="op">-</span> lam <span class="op">*</span> y0.derivative</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x1</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    t0 <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    tmin <span class="op">=</span> gradient_descent(d, t0, <span class="fl">0.01</span>)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    dmin <span class="op">=</span> d(tmin)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Minimum bei ("</span>, tmin, dmin.value, <span class="st">")"</span>)</span></code><button title="In die Zwischenablage kopieren" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Minimum bei ( 4.712388977478413 1.5 )</code></pre>
</div>
<p></p><figcaption class="figure-caption">Abbildung&nbsp;3.4: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Baydin18" class="csl-entry" role="doc-biblioentry">
Baydin, Atilim Gunes, Barak A. Pearlmutter, Alexey Andreyevich Radul, und Jeffrey Mark Siskind. 2018. <span>„Automatic Differentiation in Machine Learning: a Survey“</span>. <em>Journal of Machine Learning Research</em> 18 (153): 1–43. <a href="http://jmlr.org/papers/v18/17-468.html">http://jmlr.org/papers/v18/17-468.html</a>.
</div>
<div id="ref-Gander1992" class="csl-entry" role="doc-biblioentry">
Gander, Walter. 1992. <em>Computermathematik</em>. Birkhäuser.
</div>
<div id="ref-Henrard2017ADi" class="csl-entry" role="doc-biblioentry">
Henrard, Marc. 2017. <em>Algorithmic Differentiation in Finance Explained</em>. Financial Engineering Explained. Cham: Palgrave Macmillan. <a href="https://doi.org/10.1007/978-3-319-53979-9">https://doi.org/10.1007/978-3-319-53979-9</a>.
</div>
<div id="ref-Slater2022" class="csl-entry" role="doc-biblioentry">
Slater, Max. 2022. <span>„Differentiable programming from scratch“</span>. Juli 2022. <a href="https://thenumb.at/Autodiff/">https://thenumb.at/Autodiff/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./notAD.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">AD ist nicht …</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>